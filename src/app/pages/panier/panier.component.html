<section class="panier">
  <header class="panier__header">
    <h1>Votre panier</h1>
    <div class="panier__meta">
      <span>{{ count() }} article{{ count() > 1 ? 's' : '' }}</span>
      <span class="panier__total">Total : {{ total() | currency:'EUR' }}</span>
      <button class="btn btn--danger" (click)="clear()" [disabled]="count() === 0">Vider le panier</button>
    </div>
  </header>
  
  <ng-container *ngIf="(items$ | async) as items">
    <div *ngIf="items.length; else empty">
      <ul class="panier__list">
        <li *ngFor="let it of items; trackBy: trackById" class="panier__item">
          <img [ngSrc]="it.produit.imageUrl" width="96" height="96" [alt]="it.produit.nom" class="panier__img" />

          <div class="panier__content">
            <h3 class="panier__title">{{ it.produit.nom }}</h3>
            <p class="panier__price">{{ it.produit.prix | currency:'EUR' }}</p>

            <div class="panier__qty">
              <button class="qty-btn" (click)="dec(it.produit.id)" aria-label="Diminuer">−</button>
              <input class="qty-input" [value]="it.qty" readonly aria-label="Quantité" />
              <button class="qty-btn" (click)="inc(it.produit.id)" aria-label="Augmenter">+</button>
            </div>
          </div>

          <button class="remove-btn" (click)="remove(it.produit.id)" aria-label="Supprimer">✕</button>
        </li>
      </ul>
    </div>

    <ng-template #empty>
      <div class="panier__empty">
        <p>Votre panier est vide.</p>
      </div>
    </ng-template>
  </ng-container>
</section>
